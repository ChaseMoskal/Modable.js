!function(e){window.Modable=e()}(function(){function e(e){document.documentMode?"complete"===document.readyState?e():document.addEventListener("readystatechange",function(){"complete"===document.readyState&&e()}):"loading"!==document.readyState?e():document.addEventListener("DOMContentLoaded",e)}function t(e,t){return e.hasAttribute(t)?e.getAttribute(t):null}function a(e,a){var n=t(e,"class");return n=(n?n:"")+(n?" ":"")+a,e.setAttribute("class",n),n}function n(e){function t(){var e=window.innerHeight*d;l.style.top=window.pageYOffset+e+"px",l.style.height=window.innerHeight-2*e+"px"}function i(e){if(o.escape&&27===e.keyCode){var t=c.querySelector(".modable-base:last-of-type");t&&t.modable.close()}}if(!(this instanceof n))return new n(e);var o=this,d=o.frameSpacing=e&&void 0!==e.frameSpacing?e.frameSpacing:.1,s=e&&e.classy?e.classy:"",l=(o.escape=e&&void 0!==e.escape?e.escape:!0,o.animTime=e&&void 0!==e.animTime?e.animTime:400,o.base=document.createElement("div"));a(l,"modable-base"),a(l,s),l.style.top=100*d+"%",l.style.right=100*d+"%",l.style.left=100*d+"%",Object.keys(n.prototype).forEach(function(e){l[e]=n.prototype[e].bind(o)}),l.modable=o,c.appendChild(l),o.dispatch("modable_appear")&&(l.setAttribute("data-fade","0"),l.style.transition="opacity "+o.animTime+"ms ease",r(function(){r(function(){l.setAttribute("data-fade","1"),setTimeout(function(){o.dispatch("modable_appeared")},o.animTime)})}));var m=o.blanket=document.createElement("div");m.setAttribute("class","modable-blanket"),l.appendChild(m),window.addEventListener("resize",t),l.addEventListener("modable_disappeared",function(){window.removeEventListener("resize",t)}),t(),document.addEventListener("keyup",i),l.addEventListener("modable_disappeared",function(){document.removeEventListener("keyup",i)})}function i(e){if(!(this instanceof i))return new i(e);var t=this;n.apply(t,arguments);var o=e&&e.src?e.src:"http://upload.wikimedia.org/wikipedia/commons/thumb/6/6b/White_Tiger_in_Touroparc.jpg/1280px-White_Tiger_in_Touroparc.jpg",r=e&&e.alt?e.alt:"";a(t.base,"modable-image-base");var d=t.image=document.createElement("img");d.setAttribute("class","modable-image"),d.src=o,d.alt=r,t.base.appendChild(d);var s=t.close.bind(t);t.blanket.addEventListener("click",s),d.addEventListener("click",s)}function o(e,t){return e&&e instanceof HTMLElement?e.hasAttribute(t)?e:o(e.parentNode,t):null}var r=window.requestAnimationFrame?window.requestAnimationFrame:function(e){setTimeout(e,0)};n.requestAnimationFrame=r,n.onDocumentReady=e;var d=!document.documentMode&&window.CustomEvent?window.CustomEvent:function(){function e(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var a=document.createEvent("CustomEvent");return a.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),a}return e.prototype=Object.create(Event.prototype),e.prototype.constructor=e,e}();n.CustomEvent=d,n.attr=t,n.addClass=a;var s=n.coreStyle=document.createElement("style");s.setAttribute("data-modable-core-style",""),s.innerHTML='.modable-club {position: relative;z-index: 7777;text-align: center;}.modable-base {position:absolute; z-index:1;top:10%; left:10%; right:10%;}.modable-base[data-fade] {transition: opacity 400ms ease;opacity: 0;}.modable-base[data-fade="1"] {opacity: 1;}.modable-blanket {position:fixed; z-index:-1;top:0; right:0; bottom:0; left:0;background: rgba(0,0,0, 0.8);}',e(function(){document.head.insertBefore(s,document.head.firstChild)});var c=n.club=document.createElement("div");a(c,"modable-club"),e(function(){document.body.insertBefore(c,document.body.firstChild)});var l={modable_appear:{bubbles:!0,cancelable:!0},modable_appeared:{bubbles:!0,cancelable:!1},modable_disappear:{bubbles:!0,cancelable:!0},modable_disappeared:{bubbles:!0,cancelable:!1}};n.events={};for(var m in l){var u=l[m],b=n.events[m]=new d(m,u);b.modable=null}return n.prototype.dispatch=function(e,t){var a=this;return e instanceof d||(e=n.events[e]),e.modable=a,e.detail=t,a.base.dispatchEvent(e)},n.prototype.close=function(){var e=this;e.closing||(e.closing=!0,e.dispatch("modable_disappear")&&(e.base.setAttribute("data-fade","0"),setTimeout(function(){e.terminate()},e.animTime)))},n.prototype.terminate=function(){var e=this;e.dispatch("modable_disappeared"),n.club.removeChild(e.base)},s.innerHTML+=".modable-image {width: auto;height: auto;max-width: 100%;max-height: 100%;border-radius: 4px;box-shadow: 1px 2px 6px rgba(0,0,0, 0.4);}",n.Image=i,i.prototype=Object.create(n.prototype),i.prototype.constructor=n.Image,n.nearestElementWithAttr=o,e(function(){document.body.addEventListener("click",function(e){var a=o(e.target,"modable-image");if(null===a&&(a=o(e.target,"data-modable-image")),null!==a){var i=t(a,"modable-image");null===i&&(i=t(a,"data-modable-image"));var r;if(i)r=i;else{var d=a.tagName.toLowerCase();"img"===d?r=t(a,"src"):"a"===d&&(r=t(a,"href"))}return new n.Image({src:r}),e.preventDefault(),!1}})}),n});
//# sourceMappingURL=Modable.min.js.map