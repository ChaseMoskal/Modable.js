{"version":3,"sources":["Modable.js"],"names":["mod","window","Modable","onDocumentReady","callback","document","documentMode","readyState","addEventListener","attr","element","attribute","hasAttribute","getAttribute","addClass","classy","c","setAttribute","options","framingAdjustment","padding","innerHeight","frameSpacing","base","style","top","pageYOffset","height","escaper","e","modable","escape","keyCode","club","querySelector","close","this","undefined","animTime","createElement","right","left","Object","keys","prototype","forEach","key","bind","appendChild","dispatch","transition","requestAnimationFrame","setTimeout","blanket","removeEventListener","ModableImage","apply","arguments","src","alt","image","closer","nearestElementWithAttr","HTMLElement","parentNode","f","CustomEvent","name","params","bubbles","cancelable","detail","createEvent","initCustomEvent","create","Event","constructor","coreStyle","innerHTML","head","insertBefore","firstChild","body","eventOptions","modable_appear","modable_appeared","modable_disappear","modable_disappeared","events","eventName","eo","dispatchEvent","closing","terminate","removeChild","Image","target","modableImageAttr","tag","tagName","toLowerCase","preventDefault"],"mappings":"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","file":"Modable.min.js","sourcesContent":["(function(mod){\n\twindow.Modable = mod();\n\n})(function MODABLE_MODULE () {\n\n\n\t//==========================================================================\n\t//:::: UTILITIES AND POLYFILLS :::::::::::::::::::::::::::::::::::::::::::::\n\t//==========================================================================\n\t//##########################################################################\n\n\t// REQUEST ANIMATION FRAME POLYFILL\n\tvar requestAnimationFrame = (window.requestAnimationFrame)\n\t\t? window.requestAnimationFrame\n\t\t: function requestAnimationFramePolyfill (f) { setTimeout(f, 0); };\n\tModable.requestAnimationFrame = requestAnimationFrame;\n\n\t// ON DOCUMENT READY (POLYFILL)\n\tfunction onDocumentReady (callback) {\n\t\tif (document.documentMode) {\n\t\t\tif (document.readyState === 'complete') callback();\n\t\t\telse {\n\t\t\t\tdocument.addEventListener('readystatechange', function(){\n\t\t\t\t\tif (document.readyState === \"complete\") callback();\n\t\t\t\t});\n\t\t\t}\n\t\t} else {\n\t\t\tif (document.readyState !== 'loading') callback();\n\t\t\telse document.addEventListener('DOMContentLoaded', callback);\n\t\t}\n\t} Modable.onDocumentReady = onDocumentReady;\n\n\t// CUSTOM DOM EVENTS\n\tvar CustomEvent = (!(document.documentMode || !window.CustomEvent))\n\t\t? window.CustomEvent\n\t\t: (function POLYFILL_CUSTOM_EVENT () {\n\t\t\tfunction CustomEvent (name, params) {\n\t\t\t\tparams = params || { bubbles: false, cancelable: false, detail: undefined };\n\t\t\t\tvar e = document.createEvent('CustomEvent');\n\t\t\t\te.initCustomEvent(name, params.bubbles, params.cancelable, params.detail);\n\t\t\t\treturn e;\n\t\t\t}\n\t\t\tCustomEvent.prototype = Object.create(Event.prototype);\n\t\t\tCustomEvent.prototype.constructor = CustomEvent;\n\t\t\treturn CustomEvent;\n\t\t})();\n\tModable.CustomEvent = CustomEvent;\n\n\t// Simple cross-platform attribute getter\n\tfunction attr (element, attribute) {\n\t\treturn (element.hasAttribute(attribute))\n\t\t\t? element.getAttribute(attribute)\n\t\t\t: null;\n\t} Modable.attr = attr;\n\n\t// Easily add to an HTMLElement's [class] attribute\n\tfunction addClass (element, classy) {\n\t\tvar c = attr(element, 'class');\n\t\tc = (c?c:'') + (c?' ':'') + classy;\n\t\telement.setAttribute('class', c);\n\t\treturn c;\n\t} Modable.addClass = addClass;\n\n\n\t//==========================================================================\n\t//:::: INITIALIZE ::::::::::::::::::::::::::::::::::::::::::::::::::::::::::\n\t//==========================================================================\n\t//##########################################################################\n\t // Initializes coreStyle, the club, and custom events\n\n\t//////// CORE STYLE ////////////////////////////////////////////////////////\n\t////////////////////////////////////////////////////////////////////////////\n\n\tvar coreStyle = Modable.coreStyle = document.createElement('style');\n\tcoreStyle.setAttribute('data-modable-core-style', '');\n\tcoreStyle.innerHTML = ''\n\t\t//////// CLUB ////////\n\t\t//////////////////////\n\t\t+ '.modable-club {'\n\t\t+     'position: relative;'\n\t\t+     'z-index: 7777;'\n\t\t+     'text-align: center;'\n\t\t+ '}'\n\t\t//////// BASE ////////\n\t\t//////////////////////\n\t\t+ '.modable-base {'\n\t\t+     'position:absolute; z-index:1;'\n\t\t+     'top:10%; left:10%; right:10%;'\n\t\t+ '}'\n\t\t+ '.modable-base[data-fade] {'\n\t\t+     'transition: opacity 400ms ease;'\n\t\t+     'opacity: 0;'\n\t\t+ '}'\n\t\t+ '.modable-base[data-fade=\"1\"] {'\n\t\t+     'opacity: 1;'\n\t\t+ '}'\n\t\t//////// BLANKET ////////\n\t\t/////////////////////////\n\t\t+ '.modable-blanket {'\n\t\t+     'position:fixed; z-index:-1;'\n\t\t+     'top:0; right:0; bottom:0; left:0;'\n\t\t+     'background: rgba(0,0,0, 0.8);'\n\t\t+ '}'\n\t;\n\n\tonDocumentReady(function(){\n\t\tdocument.head.insertBefore(coreStyle, document.head.firstChild);\n\t});\n\n\t//////// CLUB //////////////////////////////////////////////////////////////\n\t////////////////////////////////////////////////////////////////////////////\n\n\tvar club = Modable.club = document.createElement('div');\n\taddClass(club, 'modable-club');\n\t\n\tonDocumentReady(function(){\n\t\tdocument.body.insertBefore(club, document.body.firstChild);\n\t})\n\t\n\t//////// MODABLE'S CUSTOM EVENTS ////////\n\t/////////////////////////////////////////\n\n\tvar eventOptions = {\n\t\tmodable_appear:      { bubbles: true, cancelable: true  }, // Appear animation begins (cancelable)\n\t\tmodable_appeared:    { bubbles: true, cancelable: false }, // Appear animation completed\n\t\tmodable_disappear:   { bubbles: true, cancelable: true  }, // Disappear animation begins (cancelable)\n\t\tmodable_disappeared: { bubbles: true, cancelable: false }  // Disappear animation completed\n\t};\n\n\tModable.events = {};\n\n\tfor (var eventName in eventOptions) {\n\t\tvar eo = eventOptions[eventName];\n\t\tvar e = Modable.events[eventName] = new CustomEvent(eventName, eo);\n\t\te.modable = null;\n\t}\n\n\n\t//==========================================================================\n\t//:::: CONSTRUCTOR :::::::::::::::::::::::::::::::::::::::::::::::::::::::::\n\t//==========================================================================\n\t//##########################################################################\n\n\tfunction Modable (options) {\n\t\tif (!(this instanceof Modable)) return new Modable(options); // Newless usage.\n\t\tvar modable = this; // self-reference\n\n\t\t//////// OPTIONS ///////////////////////////////////////////////////////\n\t\t////////////////////////////////////////////////////////////////////////\n\n\t\tvar frameSpacing = modable.frameSpacing\n\t\t\t= (options && options.frameSpacing!==undefined)\n\t\t\t\t? options.frameSpacing\n\t\t\t\t: 1/10;\n\n\t\tvar classy\n\t\t\t= (options && options.classy)\n\t\t\t\t? options.classy\n\t\t\t\t: \"\";\n\n\t\tvar escape = modable.escape\n\t\t\t= (options && options.escape!==undefined)\n\t\t\t\t? options.escape\n\t\t\t\t: true; // Defaults to true\n\n\t\tvar animTime = modable.animTime\n\t\t\t= (options && options.animTime!==undefined)\n\t\t\t\t? options.animTime\n\t\t\t\t: 400;\n\n\t\t//////// MODABLE BASE //////////////////////////////////////////////////\n\t\t////////////////////////////////////////////////////////////////////////\n\t\t // Root element for each individual modable\n\n\t\tvar base = modable.base = document.createElement(\"div\");\n\t\taddClass(base, 'modable-base');\n\t\taddClass(base, classy);\n\n\t\t// DIRECT STYLES\n\t\tbase.style.top   = (100 * frameSpacing) + \"%\";\n\t\tbase.style.right = (100 * frameSpacing) + \"%\";\n\t\tbase.style.left  = (100 * frameSpacing) + \"%\";\n\n\t\t// HTML ELEMENT INHERITS MODABLE PROTOTYPE METHODS\n\t\tObject.keys(Modable.prototype).forEach(function (key) {\n\t\t\tbase[key] = Modable.prototype[key].bind(modable);\n\t\t});\n\t\tbase.modable = modable;\n\n\t\t// ATTACHING TO DOM\n\t\tclub.appendChild(base);\n\n\t\t//////// APPEARANCE ////////\n\t\t////////////////////////////\n\n\t\tif (modable.dispatch('modable_appear')) {\n\t\t\tbase.setAttribute('data-fade', \"0\");\n\t\t\tbase.style.transition = 'opacity '+modable.animTime+'ms ease';\n\t\t\trequestAnimationFrame(function(){\n\t\t\t\trequestAnimationFrame(function(){ // DOUBLE FOR FIREFOX!\n\t\t\t\t\tbase.setAttribute('data-fade', \"1\");\n\t\t\t\t\tsetTimeout(function(){\n\t\t\t\t\t\tmodable.dispatch('modable_appeared');\n\t\t\t\t\t}, modable.animTime);\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\t\t//////// MODABLE BLANKET ///////////////////////////////////////////////\n\t\t////////////////////////////////////////////////////////////////////////\n\t\t // Dark overlay, generally blocks other page interaction\n\n\t\tvar blanket = modable.blanket = document.createElement(\"div\");\n\t\tblanket.setAttribute(\"class\", \"modable-blanket\");\n\t\tbase.appendChild(blanket);\n\t\t\n\t\t//////// FRAMING ADJUSTMENT ////////\n\t\t////////////////////////////////////\n\n\t\tfunction framingAdjustment () {\n\t\t\t\t// I need to figure out a way to account for natural document \n\t\t\t\t// margin/padding that isn't zeroed (with `*{margin:0;padding:0;}`)\n\t\t\t\t//var bodyMarginTop = parseInt(window.getComputedStyle(document.body).marginTop.replace(/[^\\d]/g, ''));\n\t\t\t// ONLY AFFECTS VERTICAL ADJUSTMENT\n\t\t\tvar padding = window.innerHeight * frameSpacing;\n\t\t\tbase.style.top = (window.pageYOffset + padding) + \"px\";\n\t\t\tbase.style.height = (window.innerHeight - (padding*2)) + \"px\";\n\t\t}\n\t\twindow.addEventListener('resize', framingAdjustment);\n\t\tbase.addEventListener('modable_disappeared', function stopFramingAdjustment () {\n\t\t\twindow.removeEventListener('resize', framingAdjustment);\n\t\t});\n\t\tframingAdjustment();\n\n\t\t//////// ESCAPER ///////////////////////////////////////////////////////\n\t\t////////////////////////////////////////////////////////////////////////\n\n\t\tfunction escaper (e) {\n\t\t\tif (modable.escape && e.keyCode === 27) {\n\t\t\t\tvar base = club.querySelector('.modable-base:last-of-type');\n\t\t\t\tif (base) base.modable.close();\n\t\t\t}\n\t\t}\n\t\tdocument.addEventListener('keyup', escaper);\n\t\tbase.addEventListener('modable_disappeared', function stopEscaper(){\n\t\t\tdocument.removeEventListener('keyup', escaper);\n\t\t});\n\t}\n\n\n\t//==========================================================================\n\t//:::: PROTOTYPE INSTANCE METHODS ::::::::::::::::::::::::::::::::::::::::::\n\t//==========================================================================\n\t//##########################################################################\n\t // Modable HTMLElement inherits these prototype methods!\n\n\tModable.prototype.dispatch = function dispatch (e, detail) {\n\t\tvar modable = this;\n\t\tif (!(e instanceof CustomEvent)) e = Modable.events[e];\n\t\te.modable = modable;\n\t\te.detail = detail;\n\t\treturn modable.base.dispatchEvent(e);\n\t};\n\n\tModable.prototype.close = function close () { // Idempotent\n\t\tvar modable = this;\n\t\tif (!modable.closing) {\n\t\t\tmodable.closing = true;\n\t\t\tif (modable.dispatch('modable_disappear')) {\n\t\t\t\tmodable.base.setAttribute('data-fade', \"0\");\n\t\t\t\tsetTimeout(function(){\n\t\t\t\t\tmodable.terminate();\n\t\t\t\t}, modable.animTime);\n\t\t\t}\n\t\t}\n\t};\n\n\tModable.prototype.terminate = function terminate () {\n\t\tvar modable = this;\n\t\tmodable.dispatch('modable_disappeared');\n\t\tModable.club.removeChild(modable.base);\n\t};\n\n\n\t//==========================================================================\n\t//:::: MODABLE IMAGE :::::::::::::::::::::::::::::::::::::::::::::::::::::::\n\t//==========================================================================\n\t//##########################################################################\n\n\t//////// CORE STYLE FOR IMAGE //////////////////////////////////////////////\n\t////////////////////////////////////////////////////////////////////////////\n\n\tcoreStyle.innerHTML += ''\n\t\t+ '.modable-image {'\n\t\t+     'width: auto;'\n\t\t+     'height: auto;'\n\t\t+     'max-width: 100%;'\n\t\t+     'max-height: 100%;'\n\t\t+     'border-radius: 4px;'\n\t\t+     'box-shadow: 1px 2px 6px rgba(0,0,0, 0.4);'\n\t\t+ '}';\n\n\t//////// MODABLE IMAGE CONSTRUCTOR /////////////////////////////////////////\n\t////////////////////////////////////////////////////////////////////////////\n\n\tfunction ModableImage (options) {\n\t\tif (!(this instanceof ModableImage)) return new ModableImage(options); // Allowing newless usage.\n\t\tvar modable = this;\n\n\t\tModable.apply(modable, arguments); // ModableImage is a Modable\n\t\t\n\t\t//////// OPTIONS ////////\n\t\t/////////////////////////\n\n\t\tvar src = (options && options.src)\n\t\t\t? options.src\n\t\t\t: \"http://upload.wikimedia.org/wikipedia/commons/thumb/6/6b/White_Tiger_in_Touroparc.jpg/1280px-White_Tiger_in_Touroparc.jpg\";\n\n\t\tvar alt = (options && options.alt)\n\t\t\t? options.alt\n\t\t\t: \"\";\n\n\t\t//////// ADDING TO SOME CLASS TO THE BASE ////////\n\t\t//////////////////////////////////////////////////\n\n\t\taddClass(modable.base, 'modable-image-base');\n\t\t\n\t\t//////// IMAGE ELEMENT ////////\n\t\t///////////////////////////////\n\n\t\tvar image = modable.image = document.createElement(\"img\");\n\t\timage.setAttribute(\"class\", \"modable-image\");\n\t\timage.src = src;\n\t\timage.alt = alt;\n\t\tmodable.base.appendChild(image);\n\n\t\t//////// CLICK TO CLOSE BLANKET ////////\n\t\t////////////////////////////////////////\n\n\t\tvar closer = modable.close.bind(modable);\n\t\tmodable.blanket.addEventListener('click', closer);\n\t\timage.addEventListener('click', closer);\n\t\t\n\t} Modable.Image = ModableImage;\n\n\t//////// MODABLE IMAGE INHERITANCE /////////////////////////////////////////\n\t////////////////////////////////////////////////////////////////////////////\n\n\tModableImage.prototype = Object.create(Modable.prototype);\n\tModableImage.prototype.constructor = Modable.Image;\n\n\n\t//==========================================================================\n\t//:::: DATA-MODABLE-IMAGE ATTRIBUTE AUTO-MODABLE :::::::::::::::::::::::::::\n\t//==========================================================================\n\t//##########################################################################\n\n\t// Recursively find the nearest node which has the given attribute\n\tfunction nearestElementWithAttr (element, attr) {\n\t\tif (!element || !(element instanceof HTMLElement)) return null;\n\t\tif (element.hasAttribute(attr)) return element;\n\t\treturn nearestElementWithAttr(element.parentNode, attr);\n\t} Modable.nearestElementWithAttr = nearestElementWithAttr;\n\n\t// HANDLE MODAL-IMAGE CLICKS!\n\tonDocumentReady(function autoModableImages () {\n\t\tdocument.body.addEventListener(\"click\", function(e){\n\t\t\t// Getting the nearest modable-image endowed element\n\t\t\tvar element = nearestElementWithAttr(e.target, \"modable-image\");\n\t\t\tif (element === null) element = nearestElementWithAttr(e.target, \"data-modable-image\");\n\n\t\t\tif (element !== null) { // If a modable-image endowed element was found:\n\t\t\t\t// Getting the attribute\n\t\t\t\tvar modableImageAttr = attr(element, \"modable-image\");\n\t\t\t\tif (modableImageAttr === null) modableImageAttr = attr(element, \"data-modable-image\");\n\n\t\t\t\t// Determining the image src\n\t\t\t\tvar src;\n\t\t\t\tif (modableImageAttr) src = modableImageAttr;\n\t\t\t\telse {\n\t\t\t\t\tvar tag = element.tagName.toLowerCase();\n\t\t\t\t\tif (tag === 'img') src = attr(element, \"src\");\n\t\t\t\t\telse if (tag === 'a') src = attr(element, \"href\")\n\t\t\t\t}\n\n\t\t\t\t// Creating the new modable\n\t\t\t\tnew Modable.Image({ src: src });\n\n\t\t\t\te.preventDefault(); // Preventing link behavior\n\t\t\t\treturn false; // Preventing event bubbling\n\t\t\t}\n\t\t});\n\t});\n\n\n\treturn Modable;\n});"],"sourceRoot":"/source/"}